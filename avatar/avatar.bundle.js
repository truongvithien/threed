!function(e){function a(a){for(var s,r,n=a[0],l=a[1],d=a[2],c=0,u=[];c<n.length;c++)r=n[c],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);for(_&&_(a);u.length;)u.shift()();return o.push.apply(o,d||[]),t()}function t(){for(var e,a=0;a<o.length;a++){for(var t=o[a],s=!0,n=1;n<t.length;n++){var l=t[n];0!==i[l]&&(s=!1)}s&&(o.splice(a--,1),e=r(r.s=t[0]))}return e}var s={},i={1:0},o=[];function r(a){if(s[a])return s[a].exports;var t=s[a]={i:a,l:!1,exports:{}};return e[a].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=s,r.d=function(e,a,t){r.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,a){if(1&a&&(e=r(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var s in e)r.d(t,s,function(a){return e[a]}.bind(null,s));return t},r.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(a,"a",a),a},r.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},r.p="";var n=window.webpackJsonp=window.webpackJsonp||[],l=n.push.bind(n);n.push=a,n=n.slice();for(var d=0;d<n.length;d++)a(n[d]);var _=l;o.push([18,0]),t()}({1:function(e,a,t){"use strict";(function(e){var s=t(0),i={create_light:{environment_light:function(a){var t=e.extend({enable:!0,options:{dir:"assets/hdr/",hdri_file:"provence_studio_1k_edit.hdr",enable_background:!1,intensity:1}},a);(new s.RGBELoader).setPath(t.dir).load(t.hdri_file,(function(e){e.mapping=s.EquirectangularReflectionMapping,t.enable_background&&(scene.background=e),scene.environment=e}))},point_light:function(a){var t=e.extend({enable:!0,helper:!1,options:{debug_color:16711680,color:16777215,decay:1,distance:100,intensity:.6,physically_correct:0,power:0,shadow_bias:-.01,map_size_width:1e3,map_size_height:2e3,camera_near:.5,camera_far:500,position:{x:4,y:4,z:4}}},a),i=new s.SphereGeometry(.2,32,32);if(t.options){var o=new s.PointLight(t.options.color,t.options.intensity,t.options.distance,t.options.decay,t.options.physically_correct);return t.helper&&o.add(new s.Mesh(i,new s.MeshBasicMaterial({color:t.options.debug_color}))),o.castShadow=!0,o.shadow.bias=t.options.shadow_bias,o.position.set(t.options.position.x,t.options.position.y,t.options.position.z),o}},dir_light:function(a){var t=e.extend({enable:!0,helper:!1,options:{debug_color:16711680,color:16777215,decay:1,distance:100,intensity:.6,physically_correct:0,power:0,shadow_bias:-.01,map_size_width:1e3,map_size_height:2e3,camera_near:.5,camera_far:500,position:{x:4,y:4,z:4}}},a);if(t.enable){light_dir=new s.DirectionalLight(16777215,.8),light_dir.color.setHSL(.1,1,.95),light_dir.position.set(-1,1.75,1),light_dir.position.multiplyScalar(100),t.light_dir&&scene.add(light_dir),light_dir.castShadow=!0,light_dir.shadow.mapSize.width=2048,light_dir.shadow.mapSize.height=2048;const e=50;if(light_dir.shadow.camera.left=-e,light_dir.shadow.camera.right=e,light_dir.shadow.camera.top=e,light_dir.shadow.camera.bottom=-e,light_dir.shadow.camera.far=3500,light_dir.shadow.bias=-1e-4,t.light_dir&&web3d.helper){const e=new s.DirectionalLightHelper(light_dir,10);scene.add(e)}}},amb_light:function(a){var t=e.extend({enable:!0,helper:!1,options:{color:4210752,intensity:.1}},a);if(t.enable)return new s.AmbientLight(t.options.color,t.options.intensity)},spot_light:function(a){var t={enable:!0,helper:!1,options:{debug_color:16711680,color:16777215,decay:1,distance:0,intensity:.6,angle:Math.PI/3,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:4,y:4,z:4},target:{x:4,y:4,z:4}}},i=e.extend(t,a);if(i.enable){var o=new s.SpotLight(i.options.color,i.options.intensity,i.options.distance,i.options.angle,i.options.penumbra,i.options.decay);if(o.position.set(i.options.position.x,i.options.position.y,i.options.position.z),o.angle=i.options.angle,o.penumbra=i.options.penumbra,o.decay=i.options.decay,o.distance=i.options.distance,o.castShadow=i.options.cast_shadow,o.shadow.camera.near=i.options.shadow_camera_near,o.shadow.camera.far=i.options.shadow_camera_far,o.shadow.focus=i.options.shadow_focus,o.receiveShadow=!0,o.castShadow=!0,o.target.position.set(i.options.target.x,i.options.target.y,i.options.target.z),i.helper){var r=new s.SpotLightHelper(o),n=new s.CameraHelper(o.shadow.camera);o.add(r),o.add(n)}return o}}},loading:function(a,t){var s=e.extend({rendered_element:"#rendered_avatar",className:"loading"},t);a?(e(s.rendered_element).addClass(s.className),e(s.rendered_element+" canvas").css({opacity:0})):(e(s.rendered_element).removeClass(s.className),e(s.rendered_element+" canvas").css({opacity:1}))},clean:function(a,t,s){e.extend({},s)}};a.a=i}).call(this,t(6))},18:function(e,a,t){e.exports=t(27)},19:function(e,a,t){"use strict";(function(e){t(23),t(26);var a=t(4);e((function(){a.a.init()})),window.addEventListener("load",(function(){var t=new URL(window.location.href),s=t.searchParams.get("load_smt");void 0!==s&&null!=s&&(0==s.length&&(s="SMT1"),a.a.loadSMT(s));var i=t.searchParams.get("load_st");if(void 0!==i&&null!=i){0==i.length&&(i="HM3-EM3-FM3-OM2-A1-T2");var o=t.searchParams.get("anim");void 0!==o&&null!=o?(0==o.length&&(o="ST_Walk"),a.a.loadSTDEMO(i,o)):a.a.loadST(i)}var r=t.searchParams.get("load_stdemo");void 0!==r&&null!=r&&(0==r.length&&(r="HM3-EM3-FM3-OM2-A1-T1"),a.a.loadSTDEMO(r));var n=t.searchParams.get("load_stfpx");switch(void 0!==n&&null!=n&&(0==n.length&&(n="HM3-EM3-FM3-OM2-A1-T1"),a.a.loadSTFPX(n)),t.searchParams.get("dim")){case"3":e("#rendered_avatar").length>0&&(e("#rendered_avatar").addClass("active"),e("#switch_avatar").prop("checked",!1),e("#switch_avatar + label .dim").html(2));break;case"2":default:e("#layered_avatar").length>0&&(e("#layered_avatar").addClass("active"),e("#switch_avatar").prop("checked",!0),e("#switch_avatar + label .dim").html(3))}})),window.debug=a.b}).call(this,t(6))},23:function(e,a,t){"use strict";(function(e){}).call(this,t(6))},27:function(e,a,t){"use strict";t.r(a);t(19)},4:function(e,a,t){"use strict";(function(e){t.d(a,"a",(function(){return s})),t.d(a,"b",(function(){return ie}));var s,i,o,r,n,l,d,_,c,u,h,f,m,p,x=t(0),g=t(9),w=t(10),b=t(5),y=t(7),M=t(17),k=t(11),S=t(12),v=t(2),A=t(13),z=t(14),P=t(15),D=t(16),O=(t(24),t(25),t(1)),H={hemi:{},dir:{},key:{},fill:{},back:{},top:{},top2:{},bottom:{},hand:{}};const B=new x.Clock;var E,j,L,T,$,R,C,I,F,W,G,N,U,J,V,X,q,K,Q,Y,Z,ee,ae,te;const se={rendered_element:"#rendered_avatar",layered_element:"#layered_avatar",switch_element:"#switch_avatar",asset_dir:"assets/avatar/",asset_dir_fbx:"assets/avatar-fbx/",asset_dir_anim:"assets/avatar-fbx/anim/",background:"assets/bg-default.glb",scale:{smt:{x:.1,y:.1,z:.1},st:{x:.08,y:.08,z:.08}},texture_options:{smt_skin:{aoMapIntensity:.1},smt_outfit:{aoMapIntensity:.1,emissiveIntensity:2,normalScale:new x.Vector2(1.5,1.5)},smt_teeth:{aoMapIntensity:.1,emissiveIntensity:2,normalScale:new x.Vector2(1.5,1.5),roughness:3},smt_hair:{aoMap:null,aoMapIntensity:.1,normalScale:new x.Vector2(1,1),roughness:1.5},st_background:{},st_text:{},st_face:{aoMap:null},st_skin:{aoMap:null,envMapIntensity:.3},st_hair:{aoMap:null,roughness:1.5},st_outfit:{aoMap:null,normalScale:new x.Vector2(2,2),envMapIntensity:.3,roughness:1.4},st_asset:{aoMap:null},st_eyewear:{aoMap:null,transparent:!0}},model_suffix:{smt:".fbx",st:".glb",st_fbx:".fbx",st_fbx_anim:"_G_Skin.fbx",twod:".png"},texture_suffix:{base_color:"_SHD_BaseColor.png",metallic:"_SHD_Metallic.png",normal:"_SHD_Normal.png",roughness:"_SHD_Roughness.png",ambient_occlusion:"_SHD_AmbientOcclusion.png",emissive:"_SHD_Emissive.png",alpha:"_SHD_Opacity.png",scattering:"_SHD_Scattering.png",thickness:"_SHD_Thickness.png",sss:"_SHD_SSS.png"},texture_skin_suffix:{base_color:"_Skin_SHD_BaseColor.png",metallic:"_Skin_SHD_Metallic.png",normal:"_Skin_SHD_Normal.png",roughness:"_Skin_SHD_Roughness.png",ambient_occlusion:"_Skin_SHD_AmbientOcclusion.png",scattering:"_Skin_SHD_Scattering.png",thickness:"_Skin_SHD_Thickness.png",sss:"_Skin_SHD_SSS.png"},texture_text_suffix:{base_color:"_Text_SHD_BaseColor.png"},post_processing:{lut_asset:"assets/lut/",lut_file:"Warm_1.siona_gut.cube",lutPass_options:{enable:!0,intensity:.3}},light_options:{environment_light:{enable:1,options:{dir:"assets/hdr/",hdri_file:"provence_studio_1k_edit.hdr",enable_background:!1}},ambient_light:{enable:1,options:{color:16777215,intensity:.8}},hemisphere_light:{enable:1,options:{skyColor:16777215,groundColor:16777215,intensity:.025,position:{x:0,y:50,z:0}}},directional_light:{enable:!1,options:{}},key_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.9,angle:Math.PI/2,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:0,shadow_camera_far:500,shadow_focus:1,position:{x:4,y:3,z:4},target:{x:0,y:2,z:0}}},fill_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.7,angle:Math.PI/3,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:-7,y:3,z:6},target:{x:0,y:4,z:0}}},back_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:1,angle:Math.PI/3,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:0,y:2,z:-4},target:{x:0,y:2,z:0}}},top_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:1.2,angle:Math.PI/5,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:0,y:7,z:3},target:{x:0,y:4,z:1}}},top2_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.4,angle:Math.PI/5,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:0,y:8,z:-3},target:{x:0,y:4,z:1}}},bottom_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.15,angle:Math.PI/3,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:-1,z:2},target:{x:0,y:3,z:0}}},hand_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.1,angle:Math.PI/3,penumbra:0,cast_shadow:!1,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:2,position:{x:3.5,y:.5,z:0},target:{x:0,y:1,z:0}}}}};s={rendered_element:se.rendered_element,layered_element:se.layered_element,switch_element:se.switch_element,rendered_element:se.rendered_element,layered_element:se.layered_element,switch_element:se.switch_element,default_bg:se.background,dom_width:100,dom_height:100,asset_dir:se.asset_dir,asset_dir_fbx:se.asset_dir_fbx,asset_dir_anim:se.asset_dir_anim,init:function(a){var t={rendered_element:se.rendered_element,layered_element:se.layered_element,switch_element:se.switch_element,asset_dir:se.asset_dir},i=e.extend(t,a);s.rendered_element=i.rendered_element,s.asset_dir=i.asset_dir,s.dom_width=e(s.rendered_element).innerWidth(),s.dom_height=e(s.rendered_element).innerHeight(),s.setup.all(),s.setup.post_renderer(),s.setup.helpers()},loadSMT:async function(a,t={}){var o={asset_dir:s.asset_dir,texture_options:se.texture_options,model_suffix:se.model_suffix,texture_suffix:se.texture_suffix,texture_skin_suffix:se.texture_skin_suffix,texture_text_suffix:se.texture_text_suffix,scale:se.scale.smt},r=e.extend(o,t);T=r.asset_dir+a+"/"+a+r.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${T}" alt="${a}">\n        `);const n=new y.a,d=new x.TextureLoader;O.a.loading(!0,{rendered_element:s.rendered_element}),O.a.clean(i),[L]=await Promise.all([n.loadAsync(r.asset_dir+a+"/"+a+r.model_suffix.smt)]);const _={map:d.load(r.asset_dir+a+"/"+a+r.texture_skin_suffix.base_color),metalnessMap:d.load(r.asset_dir+a+"/"+a+r.texture_skin_suffix.metallic),normalMap:d.load(r.asset_dir+a+"/"+a+r.texture_skin_suffix.normal),roughnessMap:d.load(r.asset_dir+a+"/"+a+r.texture_skin_suffix.roughness),aoMap:d.load(r.asset_dir+a+"/"+a+r.texture_skin_suffix.ambient_occlusion)},c={map:d.load(r.asset_dir+a+"/"+a+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+a+"/"+a+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+a+"/"+a+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+a+"/"+a+r.texture_suffix.roughness),aoMap:d.load(r.asset_dir+a+"/"+a+r.texture_suffix.ambient_occlusion),emissiveMap:d.load(r.asset_dir+a+"/"+a+r.texture_suffix.emissive)};(l=new x.AnimationMixer(L)).clipAction(L.animations[0]).play(),L.scale.set(r.scale.x,r.scale.y,r.scale.z),L.receiveShadow=!0,L.castShadow=!0;var u=new x.MeshStandardMaterial({..._,...r.texture_options.smt_skin}),h=new x.MeshStandardMaterial({...c,...r.texture_options.smt_outfit}),f=new x.MeshStandardMaterial({...c,...r.texture_options.smt_teeth}),m=new x.MeshStandardMaterial({...c,...r.texture_options.smt_hair});L.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0),e.isMesh&&["mesh_6","mesh_7","mesh_8","neck_low","hand_low","Face_low"].indexOf(e.name)>-1?e.material=u:e.isMesh&&(e.material=h),e.isMesh&&["mesh_3","Hair_low"].indexOf(e.name)>-1&&(e.material=m),e.isMesh&&"Teeth_low"==e.name&&(e.material=f)}),i.add(L),O.a.loading(!1,{rendered_element:s.rendered_element})},loadST:async function(a,t){var o={asset_dir:s.asset_dir,texture_options:se.texture_options,model_suffix:se.model_suffix,texture_suffix:se.texture_suffix,texture_skin_suffix:se.texture_skin_suffix,texture_text_suffix:se.texture_text_suffix,scale:se.scale.st},r=e.extend(o,t),n={};switch(typeof a){case"object":n=a;break;case"string":default:let e=a.split("-");n={hair:e[0],eyewear:e[1],face:e[2],outfit:e[3],asset:e[4],background_text:e[5]}}F=r.asset_dir+n.background_text+"/"+n.background_text+r.model_suffix.twod,N=r.asset_dir+n.face+"/"+n.face+r.model_suffix.twod,V=r.asset_dir+n.hair+"/"+n.hair+r.model_suffix.twod,K=r.asset_dir+n.outfit+"/"+n.outfit+r.model_suffix.twod,Z=r.asset_dir+n.asset+"/"+n.asset+r.model_suffix.twod,te=r.asset_dir+n.eyewear+"/"+n.eyewear+r.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${F}" alt="background_text">\n            <img src="${N}" alt="face">\n            <img src="${V}" alt="hair">\n            <img src="${K}" alt="outfit">\n            <img src="${Z}" alt="asset">\n            <img src="${te}" alt="eyewear">\n        `);const l=new b.a,d=new x.TextureLoader;O.a.loading(!0,{rendered_element:s.rendered_element}),O.a.clean(i),[C,W,U,X,Q,ee]=await Promise.all([l.loadAsync(r.asset_dir+n.background_text+"/"+n.background_text+r.model_suffix.st),l.loadAsync(r.asset_dir+n.face+"/"+n.face+r.model_suffix.st),l.loadAsync(r.asset_dir+n.hair+"/"+n.hair+r.model_suffix.st),l.loadAsync(r.asset_dir+n.outfit+"/"+n.outfit+r.model_suffix.st),l.loadAsync(r.asset_dir+n.asset+"/"+n.asset+r.model_suffix.st),l.loadAsync(r.asset_dir+n.eyewear+"/"+n.eyewear+r.model_suffix.st)]),I=C.scene.children[0],G=W.scene.children[0],J=U.scene.children[0],q=X.scene.children[0],Y=Q.scene.children[0],ae=ee.scene.children[0];const _={map:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.roughness)},c={map:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.roughness)},u={map:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.roughness),aoMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.ambient_occlusion)},h={map:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.roughness)},f={map:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.roughness)},m={map:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.roughness)},p={map:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.roughness),alphaMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.alpha)},g={map:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_text_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.roughness)};I.scale.set(r.scale.x,r.scale.y,r.scale.z),I.receiveShadow=!1,I.castShadow=!1;var w=new x.MeshBasicMaterial({..._,...r.texture_options.st_background}),y=new x.MeshStandardMaterial({...g,...r.texture_options.st_background});I.traverse(e=>{e.isMesh&&"mesh_0"==e.name?(e.castShadow=!0,e.receiveShadow=!0,e.material=w):e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1,e.material=y)}),console.log("BG/Text: "),console.log(I),G.scale.set(r.scale.x,r.scale.y,r.scale.z),G.receiveShadow=!0,G.castShadow=!0;var M=new x.MeshStandardMaterial({...c,...r.texture_options.st_face});G.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=M)}),console.log("Face: "),console.log(G),J.scale.set(r.scale.x,r.scale.y,r.scale.z),J.receiveShadow=!0,J.castShadow=!0;var k=new x.MeshStandardMaterial({...u,...r.texture_options.st_hair});J.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=k)}),console.log("Hair: "),console.log(J),q.scale.set(r.scale.x,r.scale.y,r.scale.z),q.receiveShadow=!0,q.castShadow=!0;var S=new x.MeshStandardMaterial({...h,...r.texture_options.st_outfit}),v=new x.MeshStandardMaterial({...f,...r.texture_options.st_skin});q.children[1].traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=S)}),q.children[0].traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=v)}),console.log("Outfit: "),console.log(q),Y.scale.set(r.scale.x,r.scale.y,r.scale.z),Y.receiveShadow=!0,Y.castShadow=!0;var A=new x.MeshStandardMaterial({...m,...r.texture_options.st_asset});v=new x.MeshStandardMaterial({...f,...r.texture_options.st_skin});Y.traverse(e=>{e.isMesh&&["mesh_1"].indexOf(e.name)>-1?(e.castShadow=!0,e.receiveShadow=!0,e.material=A):(e.castShadow=!0,e.receiveShadow=!0,e.material=v)}),console.log("Asset: "),console.log(Y),ae.scale.set(r.scale.x,r.scale.y,r.scale.z),ae.receiveShadow=!0,ae.castShadow=!0;var z=new x.MeshStandardMaterial({...p,...r.texture_options.st_eyewear});ae.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=z)}),console.log("Eyewear: "),console.log(ae),($=new x.Object3D).add(I),$.add(G),$.add(J),$.add(q),$.add(Y),$.add(ae),console.log("All: "),console.log($),i.add($),O.a.loading(!1,{rendered_element:s.rendered_element})},loadSTDEMO:async function(a,t="ST_Walk",o){var r={asset_dir:s.asset_dir,texture_options:se.texture_options,model_suffix:se.model_suffix,texture_suffix:se.texture_suffix,texture_skin_suffix:se.texture_skin_suffix,texture_text_suffix:se.texture_text_suffix,scale:se.scale.st},n=e.extend(r,o),d={};switch(typeof a){case"object":d=a;break;case"string":default:let e=a.split("-");d={hair:e[0],eyewear:e[1],face:e[2],outfit:e[3],asset:e[4],background_text:e[5]}}F=n.asset_dir+d.background_text+"/"+d.background_text+n.model_suffix.twod,N=n.asset_dir+d.face+"/"+d.face+n.model_suffix.twod,V=n.asset_dir+d.hair+"/"+d.hair+n.model_suffix.twod,K=n.asset_dir+d.outfit+"/"+d.outfit+n.model_suffix.twod,Z=n.asset_dir+d.asset+"/"+d.asset+n.model_suffix.twod,te=n.asset_dir+d.eyewear+"/"+d.eyewear+n.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${F}" alt="background_text">\n            <img src="${N}" alt="face">\n            <img src="${V}" alt="hair">\n            <img src="${K}" alt="outfit">\n            <img src="${Z}" alt="asset"> \n            <img src="${te}" alt="eyewear">\n        `);const _=new b.a,c=new y.a,u=new x.TextureLoader;O.a.loading(!0,{rendered_element:s.rendered_element}),O.a.clean(i),[C,R]=await Promise.all([_.loadAsync(n.asset_dir+d.background_text+"/"+d.background_text+n.model_suffix.st),c.loadAsync(n.asset_dir+"DEMO/"+t+n.model_suffix.smt)]),I=C.scene.children[0];const h={map:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.base_color),metalnessMap:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.metallic),normalMap:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.normal),roughnessMap:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.roughness)},f={map:u.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.base_color),metalnessMap:u.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.metallic),normalMap:u.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.normal),roughnessMap:u.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.roughness)},m={map:u.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.base_color),metalnessMap:u.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.metallic),normalMap:u.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.normal),roughnessMap:u.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.roughness),aoMap:u.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.ambient_occlusion)},p={map:u.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.base_color),metalnessMap:u.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.metallic),normalMap:u.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.normal),roughnessMap:u.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.roughness)},g={map:u.load(n.asset_dir+"DEMO/"+d.eyewear+n.texture_suffix.base_color)},w={map:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_text_suffix.base_color),metalnessMap:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.metallic),normalMap:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.normal),roughnessMap:u.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.roughness)};(l=new x.AnimationMixer(R)).clipAction(R.animations[0]).play(),I.scale.set(n.scale.x,n.scale.y,n.scale.z),I.receiveShadow=!1,I.castShadow=!1;var M=new x.MeshBasicMaterial({...h,...n.texture_options.st_background}),k=new x.MeshStandardMaterial({...w,...n.texture_options.st_background});I.traverse(e=>{e.isMesh&&"mesh_0"==e.name?(e.castShadow=!0,e.receiveShadow=!0,e.material=M):e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1,e.material=k)}),console.log("BG/Text: "),console.log(I),I.scale.set(.06,.06,.06),R.scale.set(n.scale.x,n.scale.y,n.scale.z),R.receiveShadow=!1,R.castShadow=!1;M=new x.MeshBasicMaterial({...h,...n.texture_options.st_background}),k=new x.MeshStandardMaterial({...w,...n.texture_options.st_background});var S=new x.MeshStandardMaterial({...f,...n.texture_options.st_face}),v=new x.MeshStandardMaterial({...f,...n.texture_options.st_skin}),A=new x.MeshStandardMaterial({...p,...n.texture_options.st_outfit}),z=new x.MeshStandardMaterial({...m,...n.texture_options.st_hair}),P=new x.MeshStandardMaterial({...g,...n.texture_options.st_eyewear});R.traverse(e=>{if(e.isMesh)switch(e.castShadow=!1,e.receiveShadow=!1,e.name){case"Body":case"Head_low":case"eye_low":e.material=S;break;case"Body_low":e.material=v;break;case"OM2dsdas":e.material=A;break;case"E3_low":case"eyewear":e.material=P;break;case"H3":case"hair01_low":case"hair02_low":e.material=z;break;default:e.material=v}}),console.log("Anim ST: "),console.log(R),i.add(I),i.add(R),O.a.loading(!1,{rendered_element:s.rendered_element})},loadSTFPX:async function(a,t="Walk",o){var r={asset_dir:s.asset_dir_fbx,asset_dir_anim:s.asset_dir_anim,texture_options:se.texture_options,model_suffix:se.model_suffix,texture_suffix:se.texture_suffix,texture_skin_suffix:se.texture_skin_suffix,texture_text_suffix:se.texture_text_suffix,scale:se.scale.st},n=e.extend(r,o),l={};switch(typeof a){case"object":l=a;break;case"string":default:let e=a.split("-");l={hair:e[0],eyewear:e[1],face:e[2],outfit:e[3],asset:e[4],background_text:e[5]}}F=n.asset_dir+l.background_text+"/"+l.background_text+n.model_suffix.twod,N=n.asset_dir+l.face+"/"+l.face+n.model_suffix.twod,V=n.asset_dir+l.hair+"/"+l.hair+n.model_suffix.twod,K=n.asset_dir+l.outfit+"/"+l.outfit+n.model_suffix.twod,Z=n.asset_dir+l.asset+"/"+l.asset+n.model_suffix.twod,te=n.asset_dir+l.eyewear+"/"+l.eyewear+n.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${F}" alt="background_text">\n            <img src="${N}" alt="face">\n            <img src="${V}" alt="hair">\n            <img src="${K}" alt="outfit">\n        `),"OM8"!=l.outfit&&"OF8"!=l.outfit||e(s.layered_element).append(`\n             <video src="${n.asset_dir+l.outfit+"/"+l.outfit+"_FX.mp4"}" alt="outfit-fx" muted loop autoplay style="\n                display: block;\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                width: 100%;\n                height: 100%;\n                -o-object-fit: contain;\n                object-fit: contain;\n                mix-blend-mode: plus-lighter;\n                opacity: .5;"></video>\n            `),e(s.layered_element).append(`\n            <img src="${Z}" alt="asset"> \n        `),"A8"==l.asset&&e(s.layered_element).append(`\n             <video src="${n.asset_dir+l.asset+"/"+l.asset+"_FX.mp4"}" alt="asset-fx" muted loop autoplay style="\n                display: block;\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                width: 100%;\n                height: 100%;\n                -o-object-fit: contain;\n                object-fit: contain;\n                mix-blend-mode: plus-lighter;"></video>\n            `),e(s.layered_element).append(`\n            <img src="${te}" alt="eyewear">\n        `),e(s.rendered_element).css({backgroundImage:`url(${te}),url(${Z}),url(${K}),url(${V}),url(${N}),url(${F})`});new b.a;const d=new y.a,_=new x.TextureLoader;var c,g,w,M,k,S,v,A,z;O.a.loading(!0,{rendered_element:s.rendered_element}),O.a.clean(i),[G,J,q,Y,ae,c,g,w,M,k,S,v,A,z]=await Promise.all([d.loadAsync(n.asset_dir+l.face+"/"+l.face+n.model_suffix.st_fbx_anim),d.loadAsync(n.asset_dir+l.hair+"/"+l.hair+n.model_suffix.st_fbx_anim),d.loadAsync(n.asset_dir+l.outfit+"/"+l.outfit+n.model_suffix.st_fbx_anim),d.loadAsync(n.asset_dir+l.asset+"/"+l.asset+n.model_suffix.st_fbx_anim),d.loadAsync(n.asset_dir+l.eyewear+"/"+l.eyewear+n.model_suffix.st_fbx_anim),d.loadAsync(n.asset_dir_anim+t+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Walk_Asset_Op01_A1_A4_A7"+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Walk_Asset_Op02_A3_A5_A6"+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Walk_Asset_Op03_A2_A8"+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Female/Walk_Asset_Op01_A1_A4_A7"+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Female/Walk_Asset_Op02_A3_A5_A6"+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Female/Walk_Asset_Op03_A2_A8"+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Walk_"+l.asset+n.model_suffix.st_fbx),d.loadAsync(n.asset_dir_anim+"Walk_A8_star"+n.model_suffix.st_fbx)]),R=c,console.log(l.asset);var P=0;switch(l.outfit.indexOf("OM")>-1&&(P=1),console.log(P),l.asset){case"A1":case"A4":case"A7":console.log("Walk_Asset_Op01_A1_A4_A7"),R=P?g:k;break;case"A3":case"A5":case"A6":console.log("Walk_Asset_Op02_A3_A5_A6"),R=P?w:S;break;case"A2":case"A8":console.log("Walk_Asset_Op03_A2_A8"),R=P?M:v;break;default:console.log("Walk"),A=c}"A8"==l.asset&&(A=z),console.log([G,J,q,Y,ae,R]);const D={map:_.load(n.asset_dir+l.face+"/"+l.face+n.texture_suffix.base_color),metalnessMap:_.load(n.asset_dir+l.face+"/"+l.face+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+l.face+"/"+l.face+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+l.face+"/"+l.face+n.texture_suffix.roughness)},H={map:_.load(n.asset_dir+l.hair+"/"+l.hair+n.texture_suffix.base_color),metalnessMap:_.load(n.asset_dir+l.hair+"/"+l.hair+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+l.hair+"/"+l.hair+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+l.hair+"/"+l.hair+n.texture_suffix.roughness),aoMap:_.load(n.asset_dir+l.hair+"/"+l.hair+n.texture_suffix.ambient_occlusion)},B={map:_.load(n.asset_dir+l.outfit+"/"+l.outfit+n.texture_suffix.base_color),metalnessMap:_.load(n.asset_dir+l.outfit+"/"+l.outfit+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+l.outfit+"/"+l.outfit+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+l.outfit+"/"+l.outfit+n.texture_suffix.roughness)},E={map:_.load(n.asset_dir+"Bodybase/Bodybase"+n.texture_suffix.base_color),metalnessMap:_.load(n.asset_dir+"Bodybase/Bodybase"+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+"Bodybase/Bodybase"+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+"Bodybase/Bodybase"+n.texture_suffix.roughness)},j={map:_.load(n.asset_dir+l.asset+"/"+l.asset+n.texture_suffix.base_color),metalnessMap:_.load(n.asset_dir+l.asset+"/"+l.asset+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+l.asset+"/"+l.asset+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+l.asset+"/"+l.asset+n.texture_suffix.roughness),emissiveMap:_.load(n.asset_dir+l.asset+"/"+l.asset+n.texture_suffix.emissive)},L={map:_.load(n.asset_dir+l.asset+"/A8_sparkle.jpg"),alphaMap:_.load(n.asset_dir+l.asset+"/A8_sparkle_Opacity.jpg")},T={map:_.load(n.asset_dir+l.eyewear+"/"+l.eyewear+n.texture_suffix.base_color),metalnessMap:_.load(n.asset_dir+l.eyewear+"/"+l.eyewear+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+l.eyewear+"/"+l.eyewear+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+l.eyewear+"/"+l.eyewear+n.texture_suffix.roughness),alphaMap:_.load(n.asset_dir+l.eyewear+"/"+l.eyewear+n.texture_suffix.alpha)},$={map:_.load(n.asset_dir+l.background_text+"/"+l.background_text+n.texture_text_suffix.base_color),metalnessMap:_.load(n.asset_dir+l.background_text+"/"+l.background_text+n.texture_suffix.metallic),normalMap:_.load(n.asset_dir+l.background_text+"/"+l.background_text+n.texture_suffix.normal),roughnessMap:_.load(n.asset_dir+l.background_text+"/"+l.background_text+n.texture_suffix.roughness)};var C=new x.Object3D;C.add(G),C.add(J),C.add(q),C.add(Y),C.add(ae),C.add(R),console.log("All objs: (face, hair, outfit, assets, eye, anim)"),console.log(C),C.scale.set(n.scale.x,n.scale.y,n.scale.z);(u=new x.AnimationMixer(G)).clipAction(R.animations[0]).play();(h=new x.AnimationMixer(J)).clipAction(R.animations[0]).play();(f=new x.AnimationMixer(q)).clipAction(R.animations[0]).play();(m=new x.AnimationMixer(Y)).clipAction(A.animations[0]).play();(p=new x.AnimationMixer(ae)).clipAction(R.animations[0]).play(),R.scale.set(n.scale.x,n.scale.y,n.scale.z),R.receiveShadow=!1,R.castShadow=!1,C.receiveShadow=!0,C.castShadow=!0;new x.MeshStandardMaterial({...$,...n.texture_options.st_background});var I=new x.MeshStandardMaterial({...D,...n.texture_options.st_face}),W=new x.MeshStandardMaterial({...E,...n.texture_options.st_skin}),U=new x.MeshStandardMaterial({...B,...n.texture_options.st_outfit}),X=new x.MeshStandardMaterial({...H,...n.texture_options.st_hair}),Q=new x.MeshStandardMaterial({...T,...n.texture_options.st_eyewear}),ee=new x.MeshStandardMaterial({...j,...n.texture_options.st_asset}),ie=new x.MeshStandardMaterial({...j,...n.texture_options.st_asset,...L,transparent:!0});if("A8"==l.asset)ee=new x.MeshStandardMaterial({...ee,metalness:.6});C.traverse(e=>{if(e.castShadow=!0,e.receiveShadow=!0,e.isMesh)switch(e.castShadow=!0,e.receiveShadow=!0,e.name){case"face":case"head":e.material=I;break;case"body":e.material=W;break;case"outfit":e.material=U;break;case"eyewear":e.material=Q;break;case"hair":case"hair_bot":case"hair_top":e.material=X,e.material.side=x.DoubleSide;break;case"asset":e.material=ee;break;case"Star":case"Asset_Join1":case"Asset_Join2":case"pPlane6":case"pPlane7":case"pPlane8":case"pPlane9":case"pPlane10":case"pPlane11":case"pPlane12":case"pPlane13":case"pPlane14":e.material=ie;break;default:e.material=W}}),console.log("Anim ST: "),console.log(R),i.add(C),setTimeout((function(){e(s.rendered_element).css({backgroundImage:`url(${F})`}),O.a.loading(!1,{rendered_element:s.rendered_element})}),800)},loadDefaultBg:async function(a){e.extend({},a);const t=new b.a;[E]=await Promise.all([t.loadAsync(s.default_bg)]),j=E.scene.children[0],i.add(j),j.receiveShadow=!1,j.castShadow=!0,j.scale.set(10,10,10),j.position.set(0,5,0),j.material=new x.MeshLambertMaterial({color:33709,emissive:33709,emissiveIntensity:1}),console.log(j)},setup:{all:function(a){e.extend({},a);s.setup.renderer(),s.setup.scene(),s.setup.camera(),s.setup.post_processing(),s.setup.controls(),s.setup.lights(se.light_options)},lights:function(a){var t={environment_light:{enable:!0,options:{dir:"assets/hdr/",hdri_file:"provence_studio_1k_edit.hdr",enable_background:!1,intensity:1}},ambient_light:{enable:!0,options:{color:16777215,intensity:.1}},hemisphere_light:{enable:!1,options:{skyColor:16777215,groundColor:16777215,intensity:1,position:{x:0,y:50,z:0}}},directional_light:{enable:!1,options:{}},key_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:1.95,angle:Math.PI/2,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:4,y:3,z:4},target:{x:0,y:2,z:0}}},fill_light:{enable:1,helper:0,options:{debug_color:16711680,color:16769193,decay:0,distance:50,intensity:.5,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:-7,y:3,z:6},target:{x:0,y:4,z:0}}},back_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:50,intensity:.9,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:2,z:-4},target:{x:0,y:2,z:0}}},top_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:50,intensity:.4,angle:Math.PI/5,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:8,z:3},target:{x:0,y:4,z:1}}},bottom_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:50,intensity:.4,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:-1,z:2},target:{x:0,y:3,z:0}}}},o=e.extend(t,a);if(o.environment_light.enable&&(new w.a).setPath(o.environment_light.options.dir).load(o.environment_light.options.hdri_file,(function(e){e.mapping=x.EquirectangularReflectionMapping,o.environment_light.options.enable_background&&(i.background=e),i.environment=e})),H.ambient=O.a.create_light.amb_light(o.ambient_light),o.ambient_light.enable&&i.add(H.ambient),H.key=O.a.create_light.spot_light(o.key_light),o.key_light.enable&&(i.add(H.key),i.add(H.key.target),o.key_light.helper&&console.log(H.key)),H.fill=O.a.create_light.spot_light(o.fill_light),o.fill_light.enable&&(i.add(H.fill),i.add(H.fill.target),o.fill_light.helper&&console.log(H.fill)),H.back=O.a.create_light.spot_light(o.back_light),o.back_light.enable&&(i.add(H.back),i.add(H.back.target),o.back_light.helper&&console.log(H.back)),H.top=O.a.create_light.spot_light(o.top_light),o.top_light.enable&&(i.add(H.top),i.add(H.top.target),o.top_light.helper&&console.log(H.top)),H.top2=O.a.create_light.spot_light(o.top2_light),o.top2_light.enable&&(i.add(H.top2),i.add(H.top2.target),o.top2_light.helper&&console.log(H.top2)),H.bottom=O.a.create_light.spot_light(o.bottom_light),o.bottom_light.enable&&(i.add(H.bottom),i.add(H.bottom.target),o.bottom_light.helper&&console.log(H.bottom)),H.hand=O.a.create_light.spot_light(o.hand_light),o.hand_light.enable&&(i.add(H.hand),i.add(H.hand.target),o.hand_light.helper&&console.log(H.hand)),o.hemisphere_light.enable&&(H.hemi=new x.HemisphereLight(16777215,16777215,o.hemisphere_light.options.intensity),H.hemi.position.set(0,50,0),i.add(H.hemi),s.helper)){const e=new x.HemisphereLightHelper(H.hemi,10);i.add(e)}if(o.directional_light.enable){H.dir=new x.DirectionalLight(16777215,.8),H.dir.color.setHSL(.1,1,.95),H.dir.position.set(-1,1.75,1),H.dir.position.multiplyScalar(100),o.light.dir&&i.add(H.dir),H.dir.castShadow=!0,H.dir.shadow.mapSize.width=2048,H.dir.shadow.mapSize.height=2048;const e=50;if(H.dir.shadow.camera.left=-e,H.dir.shadow.camera.right=e,H.dir.shadow.camera.top=e,H.dir.shadow.camera.bottom=-e,H.dir.shadow.camera.far=3500,H.dir.shadow.bias=-1e-4,o.light.dir&&s.helper){const e=new x.DirectionalLightHelper(H.dir,10);i.add(e)}}},scene:function(a){e.extend({},a);(i=new x.Scene).fog=new x.FogExp2(16777215,0)},renderer:function(a){e.extend({},a);(r=new x.WebGLRenderer({alpha:!0,antialias:!0,powerPreference:"default"})).setPixelRatio(window.devicePixelRatio),r.setSize(s.dom_width,s.dom_height),r.shadowMap.enabled=!0,r.shadowMap.type=x.PCFSoftShadowMap,r.physicallyCorrectLights=!0,r.outputEncoding=x.sRGBEncoding,e(s.rendered_element).append(r.domElement),window.addEventListener("resize",s.setup.onWindowResize)},post_processing:function(a){var t={lut_asset:se.post_processing.lut_asset,lut_file:se.post_processing.lut_file},n=e.extend(t,a);const l=new x.WebGLRenderTarget({minFilter:x.LinearFilter,magFilter:x.LinearFilter,format:x.RGBAFormat,encoding:x.sRGBEncoding});(d=new M.a(r,l)).setPixelRatio(window.devicePixelRatio),d.setSize(s.dom_width,s.dom_height);const u=new k.a(i,o),h=new v.a(S.a);new v.a(D.a);d.addPass(u),d.addPass(h),_=new A.a,d.addPass(_);const f=new z.a,m=new P.a;/\.CUBE$/i.test(n.lut_file)?f.load(n.lut_asset+n.lut_file,(function(e){c=e})):m.load(n.lut_asset+n.lut_file,(function(e){c=e}))},onWindowResize:function(a){e.extend({},a);o.aspect=s.dom_width/s.dom_height,o.updateProjectionMatrix(),r.setSize(s.dom_width,s.dom_height),d&&d.setSize(s.dom_width,s.dom_height),s.setup.animate()},camera:function(a){e.extend({},a);(o=new x.PerspectiveCamera(85,s.dom_width/s.dom_height,.01,1e3)).position.set(1.42,1.47,5.05),o.lookAt(0,12,0)},controls:function(a){var t=e.extend({minDistance:4,maxDistance:9,zoomSpeed:1,rotateSpeed:1,enableDamping:!0,enablePan:!1,dampingFactor:.1,autoRotate:!0,autoRotateSpeed:.5,minPolarAngle:.8,maxPolarAngle:1.8,target:{x:0,y:3,z:0}},a);(n=new g.a(o,r.domElement)).minDistance=t.minDistance,n.maxDistance=t.maxDistance,n.zoomSpeed=t.zoomSpeed,n.rotateSpeed=t.rotateSpeed,n.enableDamping=t.enableDamping,n.enablePan=t.enablePan,n.dampingFactor=t.dampingFactor,n.autoRotate=t.autoRotate,n.autoRotateSpeed=t.autoRotateSpeed,n.minPolarAngle=t.minPolarAngle,n.maxPolarAngle=t.maxPolarAngle,n.target.set(t.target.x,t.target.y,t.target.z)},helpers:function(a){var t=e.extend({gridHelper:{enable:!1,size:100,divisions:100,colorCenterLine:255,colorGrid:8421504}},a);if(t.gridHelper.enable){const e=new x.GridHelper(t.gridHelper.size,t.gridHelper.divisions,t.gridHelper.colorCenterLine,t.gridHelper.colorGrid);i.add(e)}},post_renderer:function(a){e.extend({},a);s.setup.animate(),n.addEventListener("change",(function(){s.setup.render()})),n.update()},render:function(a){e.extend({},a);d?d.render(i,o):r.render(i,o)},emissiveObjs:function(a){var t={asset_dir:s.asset_dir_fbx,asset_dir_anim:s.asset_dir_anim,texture_options:se.texture_options,model_suffix:se.model_suffix,texture_suffix:se.texture_suffix,texture_skin_suffix:se.texture_skin_suffix,texture_text_suffix:se.texture_text_suffix,scale:se.scale.st},i=(e.extend(t,a),parseInt(B.elapsedTime),new URL(window.location.href).searchParams.get("load_stfpx")),o={};if(void 0!==i&&null!=i)switch(typeof i){case"object":o=i;break;case"string":default:let e=i.split("-");o={hair:e[0],eyewear:e[1],face:e[2],outfit:e[3],asset:e[4],background_text:e[5]}}"OM8"==o.outfit&&void 0!==q&&q.children[1].traverse(e=>{e.isMesh})},animate:function(e){requestAnimationFrame(s.setup.animate);const a=B.getDelta();I&&I.lookAt(o.position.x+1.5,o.position.y-3.5,o.position.z+.5),l&&l.update(a),u&&u.update(a),f&&f.update(a),h&&h.update(a),m&&m.update(a),p&&p.update(a),s.callback(),s.setup.render(),c&&(_.enable=se.post_processing.lutPass_options.enable,_.lut=c.texture,_.intensity=se.post_processing.lutPass_options.intensity)}},callback:function(a){e.extend({},a)},switch:function(a){var t={asset_dir:s.asset_dir,texture_options:se.texture_options,texture_suffix:se.texture_suffix,texture_skin_suffix:se.texture_skin_suffix};e.extend(t,a);e("body").append('\n        <div class="controls">\n\t\t\t<input type="checkbox" id="switch_avatar" class="switch_avatar">\n\t\t\t<label for="switch_avatar">Switch to <span class="dim">3</span>D</label>\n\t\t</div>\n        ');new URL(window.location.href).searchParams.get("dim");e(s.switch_element).length,e(s.switch_element).on("click",(function(){e(s.switch_element).is(":checked")?(console.log("A"),e(s.rendered_element).removeClass("active"),e(s.layered_element).addClass("active"),e(s.switch_element+" + label .dim").html(3)):(console.log("B"),e(s.layered_element).removeClass("active"),e(s.rendered_element).addClass("active"),e(s.switch_element+" + label .dim").html(2))}))}};var ie={freeCamera:()=>{n.minDistance=0,n.maxDistance=1/0,n.zoomSpeed=1,n.rotateSpeed=1,n.enableDamping=!1,n.enablePan=!0,n.autoRotate=!0,n.autoRotateSpeed=1,n.maxPolarAngle=Math.PI},getCamera:()=>o,getControls:()=>n,getObject:e=>{switch(e){case"fake_cam_obj":return fake_cam_obj;case"smt_background_obj":return;case"smt_avatar_obj":return L;case"starter_background_obj":return I;case"starter_face_obj":return G;case"starter_hair_obj":return J;case"starter_outfit_obj":return q;case"starter_asset_obj":return Y;case"starter_eyewear_obj":return ae;case"light.hemi":return H.hemi;case"light.dir":return H.dir;case"light.key":return H.key;case"light.fill":return H.fill;case"light.back":return H.back;case"light.top":return H.top;case"light.bottom":return H.bottom}},watch:e=>(s.callback=function(){console.log(e)},"[ debug watch started ]"),endWatch:()=>(s.callback=function(){},"[ debug watch ended ]"),cleanUp:()=>{for(var e=i.children.length-1;e>=0;e--){var a=i.children[e];i.remove(a)}r.renderLists.dispose()}}}).call(this,t(6))}});