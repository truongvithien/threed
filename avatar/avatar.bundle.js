!function(e){function t(t){for(var s,r,n=t[0],l=t[1],d=t[2],c=0,h=[];c<n.length;c++)r=n[c],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&h.push(o[r][0]),o[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);for(_&&_(t);h.length;)h.shift()();return i.push.apply(i,d||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,n=1;n<a.length;n++){var l=a[n];0!==o[l]&&(s=!1)}s&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var s={},o={1:0},i=[];function r(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=s,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var n=window.webpackJsonp=window.webpackJsonp||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var d=0;d<n.length;d++)t(n[d]);var _=l;i.push([16,0]),a()}({1:function(e,t,a){"use strict";(function(e){var s=a(0),o={create_light:{environment_light:function(t){var a=e.extend({enable:!0,options:{dir:"assets/hdr/",hdri_file:"provence_studio_1k_edit.hdr",enable_background:!1,intensity:1}},t);(new s.RGBELoader).setPath(a.dir).load(a.hdri_file,(function(e){e.mapping=s.EquirectangularReflectionMapping,a.enable_background&&(scene.background=e),scene.environment=e}))},point_light:function(t){var a=e.extend({enable:!0,helper:!1,options:{debug_color:16711680,color:16777215,decay:1,distance:100,intensity:.6,physically_correct:0,power:0,shadow_bias:-.01,map_size_width:1e3,map_size_height:2e3,camera_near:.5,camera_far:500,position:{x:4,y:4,z:4}}},t),o=new s.SphereGeometry(.2,32,32);if(a.options){var i=new s.PointLight(a.options.color,a.options.intensity,a.options.distance,a.options.decay,a.options.physically_correct);return a.helper&&i.add(new s.Mesh(o,new s.MeshBasicMaterial({color:a.options.debug_color}))),i.castShadow=!0,i.shadow.bias=a.options.shadow_bias,i.position.set(a.options.position.x,a.options.position.y,a.options.position.z),i}},dir_light:function(t){var a=e.extend({enable:!0,helper:!1,options:{debug_color:16711680,color:16777215,decay:1,distance:100,intensity:.6,physically_correct:0,power:0,shadow_bias:-.01,map_size_width:1e3,map_size_height:2e3,camera_near:.5,camera_far:500,position:{x:4,y:4,z:4}}},t);if(a.enable){light_dir=new s.DirectionalLight(16777215,.8),light_dir.color.setHSL(.1,1,.95),light_dir.position.set(-1,1.75,1),light_dir.position.multiplyScalar(100),a.light_dir&&scene.add(light_dir),light_dir.castShadow=!0,light_dir.shadow.mapSize.width=2048,light_dir.shadow.mapSize.height=2048;const e=50;if(light_dir.shadow.camera.left=-e,light_dir.shadow.camera.right=e,light_dir.shadow.camera.top=e,light_dir.shadow.camera.bottom=-e,light_dir.shadow.camera.far=3500,light_dir.shadow.bias=-1e-4,a.light_dir&&web3d.helper){const e=new s.DirectionalLightHelper(light_dir,10);scene.add(e)}}},amb_light:function(t){var a=e.extend({enable:!0,helper:!1,options:{color:4210752,intensity:.1}},t);if(a.enable)return new s.AmbientLight(a.options.color,a.options.intensity)},spot_light:function(t){var a={enable:!0,helper:!1,options:{debug_color:16711680,color:16777215,decay:1,distance:0,intensity:.6,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:4,y:4,z:4},target:{x:4,y:4,z:4}}},o=e.extend(a,t);if(o.enable){var i=new s.SpotLight(o.options.color,o.options.intensity,o.options.distance,o.options.angle,o.options.penumbra,o.options.decay);if(i.position.set(o.options.position.x,o.options.position.y,o.options.position.z),i.angle=o.options.angle,i.penumbra=o.options.penumbra,i.decay=o.options.decay,i.distance=o.options.distance,i.castShadow=o.options.cast_shadow,i.shadow.camera.near=o.options.shadow_camera_near,i.shadow.camera.far=o.options.shadow_camera_far,i.shadow.focus=o.options.shadow_focus,i.receiveShadow=!0,i.castShadow=!0,i.target.position.set(o.options.target.x,o.options.target.y,o.options.target.z),o.helper){var r=new s.SpotLightHelper(i),n=new s.CameraHelper(i.shadow.camera);i.add(r),i.add(n)}return i}}},loading:function(t,a){var s=e.extend({rendered_element:"#rendered_avatar",className:"loading"},a);t?e(s.rendered_element).addClass(s.className):e(s.rendered_element).removeClass(s.className)},clean:function(t,a){e.extend({},a)}};t.a=o}).call(this,a(5))},16:function(e,t,a){e.exports=a(25)},17:function(e,t,a){"use strict";(function(e){a(21),a(24);var t=a(4);e((function(){t.a.init()})),window.addEventListener("load",(function(){var a=new URL(window.location.href),s=a.searchParams.get("load_smt");void 0!==s&&null!=s&&(0==s.length&&(s="SMT1"),t.a.loadSMT(s));var o=a.searchParams.get("load_st");if(void 0!==o&&null!=o){0==o.length&&(o="HM3-EM3-FM3-OM2-A1-T2");var i=a.searchParams.get("anim");void 0!==i&&null!=i?(0==i.length&&(i="ST_Walk"),t.a.loadSTDEMO(o,i)):t.a.loadST(o)}var r=a.searchParams.get("load_stdemo");switch(void 0!==r&&null!=r&&(0==r.length&&(r="HM3-EM3-FM3-OM2-A1-T1"),t.a.loadSTDEMO(r)),a.searchParams.get("dim")){case"3":e("#rendered_avatar").length>0&&(e("#rendered_avatar").addClass("active"),e("#switch_avatar").prop("checked",!1),e("#switch_avatar + label .dim").html(2));break;case"2":default:e("#layered_avatar").length>0&&(e("#layered_avatar").addClass("active"),e("#switch_avatar").prop("checked",!0),e("#switch_avatar + label .dim").html(3))}})),window.debug=t.b}).call(this,a(5))},21:function(e,t,a){"use strict";(function(e){}).call(this,a(5))},25:function(e,t,a){"use strict";a.r(t);a(17)},4:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return X}));var s,o,i,r,n,l,d,_,c,h=a(0),u=a(6),p=a(7),m=a(15),f=a(9),g=a(10),x=a(2),w=a(11),b=a(12),y=a(13),M=a(14),S=(a(22),a(23),a(1)),k={hemi:{},dir:{},key:{},fill:{},back:{},top:{},top2:{},bottom:{},hand:{}};const v=new h.Clock;var z,P,D,H,O,E,A,B,L,C,R,T,j,I,F,$,G,W,N,q,U,V,J,K;const Q={rendered_element:"#rendered_avatar",layered_element:"#layered_avatar",switch_element:"#switch_avatar",asset_dir:"assets/avatar/",background:"assets/bg-default.glb",scale:{smt:{x:.1,y:.1,z:.1},st:{x:.08,y:.08,z:.08}},texture_options:{smt_skin:{aoMapIntensity:.1},smt_outfit:{aoMapIntensity:.1,emissiveIntensity:2,normalScale:new h.Vector2(1.5,1.5)},smt_teeth:{aoMapIntensity:.1,emissiveIntensity:2,normalScale:new h.Vector2(1.5,1.5),roughness:3},smt_hair:{aoMap:null,aoMapIntensity:.1,normalScale:new h.Vector2(1,1),roughness:1.5},st_background:{},st_text:{},st_face:{aoMap:null},st_skin:{aoMap:null,envMapIntensity:.5},st_hair:{aoMap:null},st_outfit:{aoMap:null,envMapIntensity:0},st_asset:{aoMap:null},st_eyewear:{aoMap:null,transparent:!0}},model_suffix:{smt:".fbx",st:".glb",twod:".png"},texture_suffix:{base_color:"_SHD_BaseColor.png",metallic:"_SHD_Metallic.png",normal:"_SHD_Normal.png",roughness:"_SHD_Roughness.png",ambient_occlusion:"_SHD_AmbientOcclusion.png",emissive:"_SHD_Emissive.png",alpha:"_SHD_Opacity.png",scattering:"_SHD_Scattering.png",thickness:"_SHD_Thickness.png",sss:"_SHD_SSS.png"},texture_skin_suffix:{base_color:"_Skin_SHD_BaseColor.png",metallic:"_Skin_SHD_Metallic.png",normal:"_Skin_SHD_Normal.png",roughness:"_Skin_SHD_Roughness.png",ambient_occlusion:"_Skin_SHD_AmbientOcclusion.png",scattering:"_Skin_SHD_Scattering.png",thickness:"_Skin_SHD_Thickness.png",sss:"_Skin_SHD_SSS.png"},texture_text_suffix:{base_color:"_Text_SHD_BaseColor.png"},post_processing:{lut_asset:"assets/lut/",lut_file:"Warm_1.siona_gut.cube",lutPass_options:{enable:!0,intensity:.3}},light_options:{environment_light:{enable:1,options:{dir:"assets/hdr/",hdri_file:"provence_studio_1k_edit.hdr",enable_background:!1}},ambient_light:{enable:1,options:{color:16777215,intensity:.8}},hemisphere_light:{enable:1,options:{skyColor:16777215,groundColor:16777215,intensity:.025,position:{x:0,y:50,z:0}}},directional_light:{enable:!1,options:{}},key_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.9,angle:Math.PI/2,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:0,shadow_camera_far:500,shadow_focus:1,position:{x:4,y:3,z:4},target:{x:0,y:2,z:0}}},fill_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.7,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:-7,y:3,z:6},target:{x:0,y:4,z:0}}},back_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:1,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:0,y:2,z:-4},target:{x:0,y:2,z:0}}},top_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:1.2,angle:Math.PI/5,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:0,y:7,z:3},target:{x:0,y:4,z:1}}},top2_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.4,angle:Math.PI/5,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:1,position:{x:0,y:8,z:-3},target:{x:0,y:4,z:1}}},bottom_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.15,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:-1,z:2},target:{x:0,y:3,z:0}}},hand_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:0,intensity:.1,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:2,position:{x:3.5,y:.5,z:0},target:{x:0,y:1,z:0}}}}};s={rendered_element:Q.rendered_element,layered_element:Q.layered_element,switch_element:Q.switch_element,rendered_element:Q.rendered_element,layered_element:Q.layered_element,switch_element:Q.switch_element,default_bg:Q.background,dom_width:100,dom_height:100,asset_dir:Q.asset_dir,init:function(t){var a={rendered_element:Q.rendered_element,layered_element:Q.layered_element,switch_element:Q.switch_element,asset_dir:Q.asset_dir},o=e.extend(a,t);s.rendered_element=o.rendered_element,s.asset_dir=o.asset_dir,s.dom_width=e(s.rendered_element).innerWidth(),s.dom_height=e(s.rendered_element).innerHeight(),s.setup.all(),s.setup.post_renderer(),s.setup.helpers()},loadSMT:async function(t,a={}){var i={asset_dir:s.asset_dir,texture_options:Q.texture_options,model_suffix:Q.model_suffix,texture_suffix:Q.texture_suffix,texture_skin_suffix:Q.texture_skin_suffix,texture_text_suffix:Q.texture_text_suffix,scale:Q.scale.smt},r=e.extend(i,a);H=r.asset_dir+t+"/"+t+r.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${H}" alt="${t}">\n        `);const n=new p.a,d=new h.TextureLoader;S.a.loading(!0,{rendered_element:s.rendered_element}),S.a.clean(o),[D]=await Promise.all([n.loadAsync(r.asset_dir+t+"/"+t+r.model_suffix.smt)]);const _={map:d.load(r.asset_dir+t+"/"+t+r.texture_skin_suffix.base_color),metalnessMap:d.load(r.asset_dir+t+"/"+t+r.texture_skin_suffix.metallic),normalMap:d.load(r.asset_dir+t+"/"+t+r.texture_skin_suffix.normal),roughnessMap:d.load(r.asset_dir+t+"/"+t+r.texture_skin_suffix.roughness),aoMap:d.load(r.asset_dir+t+"/"+t+r.texture_skin_suffix.ambient_occlusion)},c={map:d.load(r.asset_dir+t+"/"+t+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+t+"/"+t+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+t+"/"+t+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+t+"/"+t+r.texture_suffix.roughness),aoMap:d.load(r.asset_dir+t+"/"+t+r.texture_suffix.ambient_occlusion),emissiveMap:d.load(r.asset_dir+t+"/"+t+r.texture_suffix.emissive)};(l=new h.AnimationMixer(D)).clipAction(D.animations[0]).play(),D.scale.set(r.scale.x,r.scale.y,r.scale.z),D.receiveShadow=!0,D.castShadow=!0;var u=new h.MeshStandardMaterial({..._,...r.texture_options.smt_skin}),m=new h.MeshStandardMaterial({...c,...r.texture_options.smt_outfit}),f=new h.MeshStandardMaterial({...c,...r.texture_options.smt_teeth}),g=new h.MeshStandardMaterial({...c,...r.texture_options.smt_hair});D.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0),e.isMesh&&["mesh_6","mesh_7","mesh_8","neck_low","hand_low","Face_low"].indexOf(e.name)>-1?e.material=u:e.isMesh&&(e.material=m),e.isMesh&&["mesh_3","Hair_low"].indexOf(e.name)>-1&&(e.material=g),e.isMesh&&"Teeth_low"==e.name&&(e.material=f)}),o.add(D),S.a.loading(!1,{rendered_element:s.rendered_element})},loadST:async function(t,a){var i={asset_dir:s.asset_dir,texture_options:Q.texture_options,model_suffix:Q.model_suffix,texture_suffix:Q.texture_suffix,texture_skin_suffix:Q.texture_skin_suffix,texture_text_suffix:Q.texture_text_suffix,scale:Q.scale.st},r=e.extend(i,a),n={};switch(typeof t){case"object":n=t;break;case"string":default:let e=t.split("-");n={hair:e[0],eyewear:e[1],face:e[2],outfit:e[3],asset:e[4],background_text:e[5]}}L=r.asset_dir+n.background_text+"/"+n.background_text+r.model_suffix.twod,T=r.asset_dir+n.face+"/"+n.face+r.model_suffix.twod,F=r.asset_dir+n.hair+"/"+n.hair+r.model_suffix.twod,W=r.asset_dir+n.outfit+"/"+n.outfit+r.model_suffix.twod,U=r.asset_dir+n.asset+"/"+n.asset+r.model_suffix.twod,K=r.asset_dir+n.eyewear+"/"+n.eyewear+r.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${L}" alt="background_text">\n            <img src="${T}" alt="face">\n            <img src="${F}" alt="hair">\n            <img src="${W}" alt="outfit">\n            <img src="${U}" alt="asset">\n            <img src="${K}" alt="eyewear">\n        `);const l=new u.a,d=new h.TextureLoader;S.a.loading(!0,{rendered_element:s.rendered_element}),S.a.clean(o),[A,C,j,$,N,V]=await Promise.all([l.loadAsync(r.asset_dir+n.background_text+"/"+n.background_text+r.model_suffix.st),l.loadAsync(r.asset_dir+n.face+"/"+n.face+r.model_suffix.st),l.loadAsync(r.asset_dir+n.hair+"/"+n.hair+r.model_suffix.st),l.loadAsync(r.asset_dir+n.outfit+"/"+n.outfit+r.model_suffix.st),l.loadAsync(r.asset_dir+n.asset+"/"+n.asset+r.model_suffix.st),l.loadAsync(r.asset_dir+n.eyewear+"/"+n.eyewear+r.model_suffix.st)]),B=A.scene.children[0],R=C.scene.children[0],I=j.scene.children[0],G=$.scene.children[0],q=N.scene.children[0],J=V.scene.children[0];const _={map:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.roughness)},c={map:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.face+"/"+n.face+r.texture_suffix.roughness)},p={map:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.roughness),aoMap:d.load(r.asset_dir+n.hair+"/"+n.hair+r.texture_suffix.ambient_occlusion)},m={map:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.outfit+"/"+n.outfit+r.texture_suffix.roughness)},f={map:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+"Bodybase/Bodybase"+r.texture_suffix.roughness)},g={map:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.asset+"/"+n.asset+r.texture_suffix.roughness)},x={map:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.roughness),alphaMap:d.load(r.asset_dir+n.eyewear+"/"+n.eyewear+r.texture_suffix.alpha)},w={map:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_text_suffix.base_color),metalnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.metallic),normalMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.normal),roughnessMap:d.load(r.asset_dir+n.background_text+"/"+n.background_text+r.texture_suffix.roughness)};B.scale.set(r.scale.x,r.scale.y,r.scale.z),B.receiveShadow=!1,B.castShadow=!1;var b=new h.MeshBasicMaterial({..._,...r.texture_options.st_background}),y=new h.MeshStandardMaterial({...w,...r.texture_options.st_background});B.traverse(e=>{e.isMesh&&"mesh_0"==e.name?(e.castShadow=!0,e.receiveShadow=!0,e.material=b):e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1,e.material=y)}),console.log("BG/Text: "),console.log(B),R.scale.set(r.scale.x,r.scale.y,r.scale.z),R.receiveShadow=!0,R.castShadow=!0;var M=new h.MeshStandardMaterial({...c,...r.texture_options.st_face});R.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=M)}),console.log("Face: "),console.log(R),I.scale.set(r.scale.x,r.scale.y,r.scale.z),I.receiveShadow=!0,I.castShadow=!0;var k=new h.MeshStandardMaterial({...p,...r.texture_options.st_hair});I.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=k)}),console.log("Hair: "),console.log(I),G.scale.set(r.scale.x,r.scale.y,r.scale.z),G.receiveShadow=!0,G.castShadow=!0;var v=new h.MeshStandardMaterial({...m,...r.texture_options.st_outfit}),z=new h.MeshStandardMaterial({...f,...r.texture_options.st_skin});G.children[1].traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=v)}),G.children[0].traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=z)}),console.log("Outfit: "),console.log(G),q.scale.set(r.scale.x,r.scale.y,r.scale.z),q.receiveShadow=!0,q.castShadow=!0;var P=new h.MeshStandardMaterial({...g,...r.texture_options.st_asset});z=new h.MeshStandardMaterial({...f,...r.texture_options.st_skin});q.traverse(e=>{e.isMesh&&["mesh_1"].indexOf(e.name)>-1?(e.castShadow=!0,e.receiveShadow=!0,e.material=P):(e.castShadow=!0,e.receiveShadow=!0,e.material=z)}),console.log("Asset: "),console.log(q),J.scale.set(r.scale.x,r.scale.y,r.scale.z),J.receiveShadow=!0,J.castShadow=!0;var D=new h.MeshStandardMaterial({...x,...r.texture_options.st_eyewear});J.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=D)}),console.log("Eyewear: "),console.log(J),(O=new h.Object3D).add(B),O.add(R),O.add(I),O.add(G),O.add(q),O.add(J),console.log("All: "),console.log(O),o.add(O),S.a.loading(!1,{rendered_element:s.rendered_element})},loadSTDEMO:async function(t,a="ST_Walk",i){var r={asset_dir:s.asset_dir,texture_options:Q.texture_options,model_suffix:Q.model_suffix,texture_suffix:Q.texture_suffix,texture_skin_suffix:Q.texture_skin_suffix,texture_text_suffix:Q.texture_text_suffix,scale:Q.scale.st},n=e.extend(r,i),d={};switch(typeof t){case"object":d=t;break;case"string":default:let e=t.split("-");d={hair:e[0],eyewear:e[1],face:e[2],outfit:e[3],asset:e[4],background_text:e[5]}}L=n.asset_dir+d.background_text+"/"+d.background_text+n.model_suffix.twod,T=n.asset_dir+d.face+"/"+d.face+n.model_suffix.twod,F=n.asset_dir+d.hair+"/"+d.hair+n.model_suffix.twod,W=n.asset_dir+d.outfit+"/"+d.outfit+n.model_suffix.twod,U=n.asset_dir+d.asset+"/"+d.asset+n.model_suffix.twod,K=n.asset_dir+d.eyewear+"/"+d.eyewear+n.model_suffix.twod,e(s.layered_element).empty(),e(s.layered_element).append(`\n            <img src="${L}" alt="background_text">\n            <img src="${T}" alt="face">\n            <img src="${F}" alt="hair">\n            <img src="${W}" alt="outfit">\n            <img src="${U}" alt="asset"> \n            <img src="${K}" alt="eyewear">\n        `);const _=new u.a,c=new p.a,m=new h.TextureLoader;S.a.loading(!0,{rendered_element:s.rendered_element}),S.a.clean(o),[A,E]=await Promise.all([_.loadAsync(n.asset_dir+d.background_text+"/"+d.background_text+n.model_suffix.st),c.loadAsync(n.asset_dir+"DEMO/"+a+n.model_suffix.smt)]),B=A.scene.children[0];const f={map:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.base_color),metalnessMap:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.metallic),normalMap:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.normal),roughnessMap:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.roughness)},g={map:m.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.base_color),metalnessMap:m.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.metallic),normalMap:m.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.normal),roughnessMap:m.load(n.asset_dir+"DEMO/Body"+n.texture_suffix.roughness)},x={map:m.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.base_color),metalnessMap:m.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.metallic),normalMap:m.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.normal),roughnessMap:m.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.roughness),aoMap:m.load(n.asset_dir+"DEMO/"+d.hair+n.texture_suffix.ambient_occlusion)},w={map:m.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.base_color),metalnessMap:m.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.metallic),normalMap:m.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.normal),roughnessMap:m.load(n.asset_dir+"DEMO/"+d.outfit+n.texture_suffix.roughness)},b={map:m.load(n.asset_dir+"DEMO/"+d.eyewear+n.texture_suffix.base_color)},y={map:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_text_suffix.base_color),metalnessMap:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.metallic),normalMap:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.normal),roughnessMap:m.load(n.asset_dir+d.background_text+"/"+d.background_text+n.texture_suffix.roughness)};(l=new h.AnimationMixer(E)).clipAction(E.animations[0]).play(),B.scale.set(n.scale.x,n.scale.y,n.scale.z),B.receiveShadow=!1,B.castShadow=!1;var M=new h.MeshBasicMaterial({...f,...n.texture_options.st_background}),k=new h.MeshStandardMaterial({...y,...n.texture_options.st_background});B.traverse(e=>{e.isMesh&&"mesh_0"==e.name?(e.castShadow=!0,e.receiveShadow=!0,e.material=M):e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1,e.material=k)}),console.log("BG/Text: "),console.log(B),B.scale.set(.06,.06,.06),E.scale.set(n.scale.x,n.scale.y,n.scale.z),E.receiveShadow=!1,E.castShadow=!1;M=new h.MeshBasicMaterial({...f,...n.texture_options.st_background}),k=new h.MeshStandardMaterial({...y,...n.texture_options.st_background});var v=new h.MeshStandardMaterial({...g,...n.texture_options.st_face}),z=new h.MeshStandardMaterial({...g,...n.texture_options.st_skin}),P=new h.MeshStandardMaterial({...w,...n.texture_options.st_outfit}),D=new h.MeshStandardMaterial({...x,...n.texture_options.st_hair}),H=new h.MeshStandardMaterial({...b,...n.texture_options.st_eyewear});E.traverse(e=>{if(e.isMesh)switch(e.castShadow=!1,e.receiveShadow=!1,e.name){case"Body":case"Head_low":case"eye_low":e.material=v;break;case"Body_low":e.material=z;break;case"OM2dsdas":e.material=P;break;case"E3_low":case"eyewear":e.material=H;break;case"H3":case"hair01_low":case"hair02_low":e.material=D;break;default:e.material=z}}),console.log("Anim ST: "),console.log(E),o.add(B),o.add(E),S.a.loading(!1,{rendered_element:s.rendered_element})},loadDefaultBg:async function(t){e.extend({},t);const a=new u.a;[z]=await Promise.all([a.loadAsync(s.default_bg)]),P=z.scene.children[0],o.add(P),P.receiveShadow=!1,P.castShadow=!0,P.scale.set(10,10,10),P.position.set(0,5,0),P.material=new h.MeshLambertMaterial({color:33709,emissive:33709,emissiveIntensity:1}),console.log(P)},setup:{all:function(t){e.extend({},t);s.setup.renderer(),s.setup.scene(),s.setup.camera(),s.setup.post_processing(),s.setup.controls(),s.setup.lights(Q.light_options)},lights:function(t){var a={environment_light:{enable:!0,options:{dir:"assets/hdr/",hdri_file:"provence_studio_1k_edit.hdr",enable_background:!1,intensity:1}},ambient_light:{enable:!0,options:{color:16777215,intensity:.1}},hemisphere_light:{enable:!1,options:{skyColor:16777215,groundColor:16777215,intensity:1,position:{x:0,y:50,z:0}}},directional_light:{enable:!1,options:{}},key_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:100,intensity:1.95,angle:Math.PI/2,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:4,y:3,z:4},target:{x:0,y:2,z:0}}},fill_light:{enable:1,helper:0,options:{debug_color:16711680,color:16769193,decay:0,distance:50,intensity:.5,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:-7,y:3,z:6},target:{x:0,y:4,z:0}}},back_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:50,intensity:.9,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:2,z:-4},target:{x:0,y:2,z:0}}},top_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:50,intensity:.4,angle:Math.PI/5,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:8,z:3},target:{x:0,y:4,z:1}}},bottom_light:{enable:1,helper:0,options:{debug_color:16711680,color:16777215,decay:0,distance:50,intensity:.4,angle:Math.PI/3,penumbra:0,cast_shadow:!0,shadow_map_size_width:512,shadow_map_size_height:512,shadow_camera_near:10,shadow_camera_far:200,shadow_focus:.2,position:{x:0,y:-1,z:2},target:{x:0,y:3,z:0}}}},i=e.extend(a,t);if(i.environment_light.enable&&(new h.RGBELoader).setPath(i.environment_light.options.dir).load(i.environment_light.options.hdri_file,(function(e){e.mapping=h.EquirectangularReflectionMapping,i.environment_light.options.enable_background&&(o.background=e),o.environment=e})),k.ambient=S.a.create_light.amb_light(i.ambient_light),i.ambient_light.enable&&o.add(k.ambient),k.key=S.a.create_light.spot_light(i.key_light),i.key_light.enable&&(o.add(k.key),o.add(k.key.target),i.key_light.helper&&console.log(k.key)),k.fill=S.a.create_light.spot_light(i.fill_light),i.fill_light.enable&&(o.add(k.fill),o.add(k.fill.target),i.fill_light.helper&&console.log(k.fill)),k.back=S.a.create_light.spot_light(i.back_light),i.back_light.enable&&(o.add(k.back),o.add(k.back.target),i.back_light.helper&&console.log(k.back)),k.top=S.a.create_light.spot_light(i.top_light),i.top_light.enable&&(o.add(k.top),o.add(k.top.target),i.top_light.helper&&console.log(k.top)),k.top2=S.a.create_light.spot_light(i.top2_light),i.top2_light.enable&&(o.add(k.top2),o.add(k.top2.target),i.top2_light.helper&&console.log(k.top2)),k.bottom=S.a.create_light.spot_light(i.bottom_light),i.bottom_light.enable&&(o.add(k.bottom),o.add(k.bottom.target),i.bottom_light.helper&&console.log(k.bottom)),k.hand=S.a.create_light.spot_light(i.hand_light),i.hand_light.enable&&(o.add(k.hand),o.add(k.hand.target),i.hand_light.helper&&console.log(k.hand)),i.hemisphere_light.enable&&(k.hemi=new h.HemisphereLight(16777215,16777215,i.hemisphere_light.options.intensity),k.hemi.position.set(0,50,0),o.add(k.hemi),s.helper)){const e=new h.HemisphereLightHelper(k.hemi,10);o.add(e)}if(i.directional_light.enable){k.dir=new h.DirectionalLight(16777215,.8),k.dir.color.setHSL(.1,1,.95),k.dir.position.set(-1,1.75,1),k.dir.position.multiplyScalar(100),i.light.dir&&o.add(k.dir),k.dir.castShadow=!0,k.dir.shadow.mapSize.width=2048,k.dir.shadow.mapSize.height=2048;const e=50;if(k.dir.shadow.camera.left=-e,k.dir.shadow.camera.right=e,k.dir.shadow.camera.top=e,k.dir.shadow.camera.bottom=-e,k.dir.shadow.camera.far=3500,k.dir.shadow.bias=-1e-4,i.light.dir&&s.helper){const e=new h.DirectionalLightHelper(k.dir,10);o.add(e)}}},scene:function(t){e.extend({},t);(o=new h.Scene).background=(new h.Color).setHSL(0,0,0),o.fog=new h.FogExp2(16777215,0)},renderer:function(t){e.extend({},t);(r=new h.WebGLRenderer({alpha:!0,antialias:!0,powerPreference:"high-performance"})).setPixelRatio(window.devicePixelRatio),r.setSize(s.dom_width,s.dom_height),r.shadowMap.enabled=!0,r.shadowMap.type=h.PCFSoftShadowMap,r.physicallyCorrectLights=!0,r.outputEncoding=h.sRGBEncoding,e(s.rendered_element).append(r.domElement),window.addEventListener("resize",s.setup.onWindowResize)},post_processing:function(t){var a={lut_asset:Q.post_processing.lut_asset,lut_file:Q.post_processing.lut_file},n=e.extend(a,t);const l=new h.WebGLRenderTarget({minFilter:h.LinearFilter,magFilter:h.LinearFilter,format:h.RGBAFormat,encoding:h.sRGBEncoding});(d=new m.a(r,l)).setPixelRatio(window.devicePixelRatio),d.setSize(s.dom_width,s.dom_height);const u=new f.a(o,i),p=new x.a(g.a);new x.a(M.a);d.addPass(u),d.addPass(p),_=new w.a,d.addPass(_);const S=new b.a,k=new y.a;/\.CUBE$/i.test(n.lut_file)?S.load(n.lut_asset+n.lut_file,(function(e){c=e})):k.load(n.lut_asset+n.lut_file,(function(e){c=e}))},onWindowResize:function(t){e.extend({},t);i.aspect=s.dom_width/s.dom_height,i.updateProjectionMatrix(),r.setSize(s.dom_width,s.dom_height),d&&d.setSize(s.dom_width,s.dom_height),s.setup.animate()},camera:function(t){e.extend({},t);(i=new h.PerspectiveCamera(85,s.dom_width/s.dom_height,.01,1e3)).position.set(1.42,1.47,5.05),i.lookAt(0,12,0)},controls:function(t){var a=e.extend({minDistance:4,maxDistance:9,zoomSpeed:1,rotateSpeed:1,enableDamping:!0,enablePan:!1,dampingFactor:.1,autoRotate:!0,autoRotateSpeed:.5,minPolarAngle:.8,maxPolarAngle:1.8,target:{x:0,y:3,z:0}},t);(n=new h.OrbitControls(i,r.domElement)).minDistance=a.minDistance,n.maxDistance=a.maxDistance,n.zoomSpeed=a.zoomSpeed,n.rotateSpeed=a.rotateSpeed,n.enableDamping=a.enableDamping,n.enablePan=a.enablePan,n.dampingFactor=a.dampingFactor,n.autoRotate=a.autoRotate,n.autoRotateSpeed=a.autoRotateSpeed,n.minPolarAngle=a.minPolarAngle,n.maxPolarAngle=a.maxPolarAngle,n.target.set(a.target.x,a.target.y,a.target.z)},helpers:function(t){var a=e.extend({gridHelper:{enable:!1,size:100,divisions:100,colorCenterLine:255,colorGrid:8421504}},t);if(a.gridHelper.enable){const e=new h.GridHelper(a.gridHelper.size,a.gridHelper.divisions,a.gridHelper.colorCenterLine,a.gridHelper.colorGrid);o.add(e)}},post_renderer:function(t){e.extend({},t);s.setup.animate(),n.addEventListener("change",(function(){s.setup.render()})),n.update()},render:function(t){e.extend({},t);d?d.render(o,i):r.render(o,i)},animate:function(e){requestAnimationFrame(s.setup.animate);const t=v.getDelta();B&&B.lookAt(i.position.x+1.5,i.position.y-3.5,i.position.z+.5),l&&l.update(t),s.callback(),s.setup.render(),c&&(_.enable=Q.post_processing.lutPass_options.enable,_.lut=c.texture,_.intensity=Q.post_processing.lutPass_options.intensity)}},callback:function(t){e.extend({},t)},switch:function(t){var a={asset_dir:s.asset_dir,texture_options:Q.texture_options,texture_suffix:Q.texture_suffix,texture_skin_suffix:Q.texture_skin_suffix};e.extend(a,t);e("body").append('\n        <div class="controls">\n\t\t\t<input type="checkbox" id="switch_avatar" class="switch_avatar">\n\t\t\t<label for="switch_avatar">Switch to <span class="dim">3</span>D</label>\n\t\t</div>\n        ');new URL(window.location.href).searchParams.get("dim");e(s.switch_element).length,e(s.switch_element).on("click",(function(){e(s.switch_element).is(":checked")?(console.log("A"),e(s.rendered_element).removeClass("active"),e(s.layered_element).addClass("active"),e(s.switch_element+" + label .dim").html(3)):(console.log("B"),e(s.layered_element).removeClass("active"),e(s.rendered_element).addClass("active"),e(s.switch_element+" + label .dim").html(2))}))}};var X={freeCamera:()=>{n.minDistance=0,n.maxDistance=1/0,n.zoomSpeed=1,n.rotateSpeed=1,n.enableDamping=!1,n.enablePan=!0,n.autoRotate=!0,n.autoRotateSpeed=1,n.maxPolarAngle=Math.PI},getCamera:()=>i,getControls:()=>n,getObject:e=>{switch(e){case"fake_cam_obj":return fake_cam_obj;case"smt_background_obj":return;case"smt_avatar_obj":return D;case"starter_background_obj":return B;case"starter_face_obj":return R;case"starter_hair_obj":return I;case"starter_outfit_obj":return G;case"starter_asset_obj":return q;case"starter_eyewear_obj":return J;case"light.hemi":return k.hemi;case"light.dir":return k.dir;case"light.key":return k.key;case"light.fill":return k.fill;case"light.back":return k.back;case"light.top":return k.top;case"light.bottom":return k.bottom}},watch:e=>(s.callback=function(){console.log(e)},"[ debug watch started ]"),endWatch:()=>(s.callback=function(){},"[ debug watch ended ]")}}).call(this,a(5))}});